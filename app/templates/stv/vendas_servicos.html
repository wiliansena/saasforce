{% extends "base_mobile.html" %}

{% block title %}Vender Servi√ßo{% endblock %}

{% block content %}

<h5 class="mb-3 fw-bold text-center">Vender Servi√ßo</h5>

<!-- Pesquisa -->
<input
  type="text"
  id="pesquisaServico"
  class="form-control mb-3"
  placeholder="üîç Buscar servi√ßo..."
>

<!-- Voltar -->
<a href="{{ url_for('routes.home') }}"
   class="btn btn-outline-info w-100 mt-2">
  ‚Üê Voltar
</a>

<hr>

<div class="grid" id="listaServicos">

  {% for d in dados %}
  <div class="grid-item"
       data-nome="{{ d.servico.nome | lower }}">

    <div class="home-card">

      {% if d.servico.imagem %}
        <img
          src="{{ url_for('static', filename=d.servico.imagem) }}"
          alt="{{ d.servico.nome }}"
          style="max-height:70px; object-fit:contain; border-radius:12px;"
        >
      {% else %}
        <i class="fas fa-tv"></i>
      {% endif %}

      <span class="fw-bold mt-1">
        {{ d.servico.nome }}
      </span>

      <div class="d-flex gap-2 mt-1">

        <span class="badge bg-success">
          Livres: {{ d.livres }}
        </span>

        <span class="badge bg-secondary">
          Vendidas: {{ d.vendidas }}
        </span>

      </div>

      <a href="{{ url_for('routes.stv_vender_servico', servico_id=d.servico.id) }}"
         class="btn btn-success w-100 mt-3 fw-bold">
        <i class="fas fa-shopping-cart"></i> Vender
      </a>

    </div>

  </div>
  {% endfor %}

</div>

<!-- JS de pesquisa -->
<script>
  const input = document.getElementById("pesquisaServico");
  const itens = document.querySelectorAll("#listaServicos .grid-item");

  input.addEventListener("input", function () {
    const termo = this.value.toLowerCase().trim();

    itens.forEach(item => {
      const nome = item.dataset.nome;
      item.style.display = nome.includes(termo) ? "" : "none";
    });
  });
</script>

{% endblock %}
